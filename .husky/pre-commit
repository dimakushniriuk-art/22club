#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Pre-commit: Verifica rapida codice..."

# 1. Formatta codice automaticamente
echo "ğŸ“ Formattazione codice..."
npm run format --silent || {
  echo "âŒ Formattazione fallita"
  exit 1
}

# 2. Fix ESLint automatici
echo "ğŸ”§ Fix ESLint automatici..."
npm run lint:fix --silent || {
  echo "âš ï¸  Alcuni problemi ESLint non corretti automaticamente"
}

# 3. TypeScript check
echo "ğŸ“˜ Verifica TypeScript..."
npm run typecheck || {
  echo "âŒ Errori TypeScript rilevati - commit bloccato"
  echo "ğŸ’¡ Correggi con: npm run typecheck"
  exit 1
}

# 4. ESLint check (dopo fix)
echo "âœ… Verifica ESLint finale..."
npm run lint || {
  echo "âŒ Errori ESLint rimanenti - commit bloccato"
  echo "ğŸ’¡ Correggi con: npm run lint:fix"
  exit 1
}

echo "âœ… Pre-commit: Tutti i controlli passati!"
